# 用于通用图像恢复的Prompt-In-Prompt

## 代码

暂无

## 现存问题

1、各种特定任务模型需要高存储成本

2、缺乏交互性和灵活性，阻碍了更广泛的应用

## 背景

提示学习通过特定的“条件”增强输入数据，在不同领域表现出灵活性，被广泛运用于大型语言模型和条件图像生成。

一个模型解决多任务

## 贡献

一、提出两个新的提示：

​	1、退化感知提示，来编码高级退化知识

​	2、基本的恢复提示，以提供基本的低级信息

二、设计一个新的提示到提示的交互模块，将以上两个提示融合到一个通用的恢复提示中。

三、引入一个选择性提示-特征交互模块，以调制特定恢复任务的退化相关特征。

四、即插即用，用于通用图像恢复。

## 模型
![image](https://github.com/Guan-qiqi/Papers-and-Models/assets/63685364/58834062-defb-4421-bfbc-0eb324cc3bb5)

### Degradation-aware prompt

在训练期间学习一组解耦的、退化感知的提示。学习这些提示是为了清楚地表示不同类型的退化。

使用一组一维向量dt表示第t个退化类型的退化感知提示。

### Basic restoration prompt

学习与任务无关的基本恢复提示，用于各种退化之间关键的低级特征，包括基本纹理和精细结构。

### Prompt-to-Prompt Interaction(P2P)

aaa

### Prompt-to-Feature Interaction(P2F)

图像恢复的挑战是用单个模型解决各种类型的退化，每个模型都关注不同的细节。

如图像去噪针对的是纹理等高频细节，而图像去模糊和弱光增强优先恢复结构和全局值的变化。

因此，设计提示-特征交互（P2F）来调节与退化最相关的特征。

#### Select prompt modulation

并非所有组件对特定图像的贡献都是相等的。提出在提示-特征交互过程中更有选择性，专注于调制与退化最相关的特征。

## 实验

对图像去噪、去雨、去雾、去模糊、弱光增强五个恢复任务进行实验。

### 数据集

去噪：BSD400、WED，加入高斯水平噪声σ∈{15,25,50}

去雨：Rain100L

去雾：SOTS

去模糊：GoPro

弱光增强：LOL

使用“噪声-雨-雾霾”三任务配置和“噪声-雨-雾-模糊-增强”五任务配置在多个数据集上联合训练和评估PIP。
